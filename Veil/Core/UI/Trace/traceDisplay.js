window;import{jsxs as n,Fragment as e,jsx as r}from"react/jsx-runtime";import*as o from"react";function t(n){return n.trim().split(/\s+/).map((n=>{let e=n.replace(/^[()\[\]{}:,]+|[()\[\]{}:,]+$/g,"");if(/^-?\d+(?:\.\d+)?$/.test(e))return e;if(e.includes(".")){const n=e.split(".");e=n[n.length-1]||e}return e})).filter((n=>n.length>0)).join(" ")}function a(n,e){if(n===e)return!0;if(null==n||null==e)return n===e;if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!a(n[r],e[r]))return!1;return!0}if("object"==typeof n&&"object"==typeof e){const r=n,o=e,t=Object.keys(r),i=Object.keys(o);if(t.length!==i.length)return!1;for(const n of t){if(!(n in o))return!1;if(!a(r[n],o[n]))return!1}return!0}return!1}function i(n,e){const r=new Set,o=Math.max(n.length,e.length);for(let t=0;t<o;t++)t>=n.length||t>=e.length?r.add(t):a(n[t],e[t])||r.add(t);return r}function s(n,o=", "){const t=[];return n.forEach(((e,a)=>{t.push(r("span",{children:e},`n-${a}`)),a<n.length-1&&t.push(r("span",{children:o},`s-${a}`))})),r(e,{children:t})}function d(e,o,a){const i=void 0!==o;if(Array.isArray(e)){const r=e.map(((n,e)=>d(n,o)));return n("code",{children:["[",s(r),"]"]})}if("object"==typeof e&&null!==e){const n=JSON.stringify(e);return r("code",i?{className:"changed-element",children:n}:{children:n})}if("string"==typeof e){const n=t(e);return r("code",i?{className:"changed-element",children:n}:{children:n})}const l=String(e);return r("code",i?{className:"changed-element",children:l}:{children:l})}function l(e,o,t){const a=void 0!==o&&void 0!==t&&o.has(t);if(Array.isArray(e)){if(e.every((n=>!Array.isArray(n)))){const o=[];e.forEach(((n,r)=>{o.push(d(n)),r<e.length-1&&o.push(", ")}));const t=n("code",{children:["(",o,")"]});return a?r("span",{className:"changed-element",children:t}):t}{const n=d(e);return a?r("span",{className:"changed-element",children:n}):n}}return c(e)}function c(e,o){if(Array.isArray(e)){if(0===e.length)return r("code",{children:"[]"});return e.some(Array.isArray)?r("ul",{className:"list",children:e.map(((n,e)=>r("li",{children:l(n,o,e)},e)))}):function(e,o){const t=[];return e.forEach(((n,a)=>{const i=void 0!==o&&o.has(a),s=d(n);t.push(r("span",i?{className:"changed-element",children:s}:{children:s},a)),a<e.length-1&&t.push(r("span",{children:", "},`comma-${a}`))})),n("code",{children:["[",t,"]"]})}(e,o)}return r("code","object"==typeof e&&null!==e?{children:JSON.stringify(e)}:"string"==typeof e?{children:t(e)}:{children:String(e)})}function p(n){if(Array.isArray(n))return n.length>0&&Array.isArray(n[0])?`Array(${n.length}) of tuples`:`Array(${n.length})`;if("object"==typeof n&&null!==n)try{return JSON.stringify(n).slice(0,80)+"â€¦"}catch{return"[object]"}if("string"==typeof n){const e=t(n).replace(/\s+/g," ");return e.length>80?e.slice(0,80)+"â€¦":e}return String(n)}const u=({k:e,v:t,changeInfo:a})=>{const i=function(n){return!!Array.isArray(n)||"object"==typeof n&&null!==n||!("string"!=typeof n||!(n.includes("\n")||n.length>60))}(t),s="full"===a?.type||"array"===a?.type,[d,l]=o.useState(!0),u=d&&"array"===a?.type?a.changedIndices:void 0;return n("div",{className:`kv-row ${i?"has-toggle":""} ${s?"changed":""}`,children:[r("div",{className:"kv-key",children:r("code",{children:e})}),r("div",{className:"kv-sep",children:"â†¦"}),n("div",{className:"kv-val "+(d?"expanded":"collapsed"),children:[i&&r("button",{className:"kv-toggle",type:"button",onClick:()=>l((n=>!n)),"aria-label":d?"Collapse value":"Expand value",title:d?"Collapse":"Expand",children:d?"â–¼":"â–¶"}),r("div",{className:"kv-content",children:d?c(t,u):r("code",{children:p(t)})})]})]})},h=({st:e,highlighted:t=!1,changes:a})=>{const[i,s]=o.useState(!0),d=Object.entries(e.fields);return n("div",{className:"state-card "+(t?"is-highlighted":""),children:[n("div",{className:"state-header",onClick:()=>s((n=>!n)),children:[r("span",{className:"action-chip",title:e.tag??"",children:e.tag||"(no action)"}),n("span",{className:"state-id",children:["(index: ",e.index,")"]}),r("div",{className:"state-toggle",children:i?"â–¼":"â–¶"})]}),i&&r("div",{className:"state-body",children:r("div",{className:"kv-table",children:d.map((([n,e])=>r(u,{k:n,v:e,changeInfo:a?.get(n)},n)))})})]})},g=({theory:e})=>{const[t,a]=o.useState(!1),i=Object.entries(e);return n("div",{className:"theory-section",children:[n("div",{className:"theory-header",onClick:()=>a((n=>!n)),children:[r("span",{className:"theory-toggle",children:t?"â–¼":"â–¶"}),r("span",{className:"theory-label",children:"Theory"})]}),t&&r("div",{className:"theory-content",children:r("div",{className:"kv-table",children:i.map((([n,e])=>r(u,{k:n,v:e},n)))})})]})},v=({resultType:e,violation:o,exploredStates:t,terminationReason:a})=>{if("found_violation"===e&&o){const e="deadlock"===o.kind?"ðŸ”’":"âš ï¸",t="deadlock"===o.kind?"Deadlock Detected":"Safety Violation Found";return n("div",{className:"result-header result-violation",children:[r("span",{className:"result-icon",children:e}),r("span",{className:"result-label",children:t}),"safety_failure"===o.kind&&o.violates&&o.violates.length>0&&n("div",{className:"result-details",children:[r("strong",{children:"Violated properties:"})," ",o.violates.join(", ")]})]})}return n("div",{className:"result-header result-success",children:[r("span",{className:"result-icon",children:"âœ“"}),r("span",{className:"result-label",children:"No Violation Found"}),r("div",{className:"result-details",children:r("span",{children:((n,e)=>{if(!n)return`Explored ${e} states`;if("explored_all_reachable_states"===n.kind)return`Explored all reachable states (${e})`;if("early_termination"===n.kind&&n.condition)switch(n.condition.kind){case"found_violating_state":return`Stopped: found violating state (explored ${e} states)`;case"deadlock_occurred":return`Stopped: deadlock occurred (explored ${e} states)`;case"reached_depth_bound":return`Reached depth bound ${n.condition.depth} (explored ${e} states)`;default:return`Early termination (explored ${e} states)`}return`Explored ${e} states`})(a,t??0)})})]})};function f(n){if("string"==typeof n)return n;if("object"==typeof n&&null!==n){const e=n,r=Object.keys(e);if(1===r.length){let n=r[0];n.startsWith("_")&&(n=n.slice(1));const o=e[r[0]];if("object"==typeof o&&null!==o&&!Array.isArray(o)){const e=o,r=Object.keys(e);if(r.length>0){const o=n=>"string"==typeof n?n:"number"==typeof n||"boolean"==typeof n?String(n):JSON.stringify(n);return`${n}(${r.map((n=>`${n} = ${o(e[n])}`)).join(", ")})`}}return n}}return JSON.stringify(n)}const m=({text:t,className:a})=>{const[i,s]=o.useState(!1);return n("button",{className:a,onClick:async()=>{try{await navigator.clipboard.writeText(t),s(!0),setTimeout((()=>s(!1)),2e3)}catch(n){console.error("Failed to copy:",n)}},title:"Copy to clipboard",children:[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i?r("path",{d:"M20 6L9 17l-5-5",strokeLinecap:"round",strokeLinejoin:"round"}):n(e,{children:[r("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),r("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]})}),i?"Copied!":"Copy JSON"]})};const b=({result:t,layout:s="vertical"})=>{const d="vertical"===s,[l,c]=o.useState(!1),p=JSON.stringify(t,null,2),u=t.trace,b=u?function(n){return n.states.map((n=>({index:n.index,tag:f(n.transition),fields:n.fields})))}(u):[],x=u?.theory;return n(e,{children:[r("style",{children:'\n    .mc-root {\n      font-family: system-ui, -apple-system, sans-serif;\n      max-width: 100%;\n      overflow: auto;\n    }\n    .mc-trace.vertical {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      padding: 8px;\n    }\n    .mc-trace.horizontal {\n      display: flex;\n      flex-direction: row;\n      gap: 8px;\n      padding: 8px;\n      overflow-x: auto;\n    }\n    .mc-summary {\n      margin: 12px 8px;\n      padding: 8px 12px;\n      background: var(--vscode-editorWidget-background);\n      border: 1px solid var(--vscode-panel-border);\n      border-radius: 4px;\n    }\n    .state-card {\n      --border: var(--vscode-panel-border);\n      --header: var(--vscode-editorGroupHeader-tabsBackground);\n      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;\n      background: var(--vscode-editorWidget-background);\n      border: 1px solid var(--border);\n      border-radius: 6px;\n      min-width: 320px;\n      max-width: 720px;\n      box-shadow: 0 1px 2px rgba(0,0,0,.08);\n      overflow: hidden;\n    }\n    .state-card.is-highlighted {\n      outline: 2px solid var(--vscode-editor-selectionHighlightBorder);\n      box-shadow: 0 0 0 3px var(--vscode-editor-selectionBackground);\n    }\n    .state-header {\n      background: var(--header);\n      border-bottom: 1px solid var(--border);\n      padding: 6px 10px;\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      font-weight: 600;\n      cursor: pointer;\n    }\n    .state-id {\n      font-size: 12px;\n      color: var(--vscode-descriptionForeground);\n      margin-left: auto;\n    }\n    .state-toggle { font-size: 12px; color: var(--vscode-descriptionForeground); user-select: none; }\n    .action-chip {\n      display: inline-block;\n      font-family: var(--mono);\n      font-size: 11px;\n      font-weight: normal;\n      background: var(--vscode-activityBarBadge-background);\n      color: var(--vscode-activityBarBadge-foreground);\n      border: 1px solid var(--vscode-activityBarBadge-foreground);\n      border-radius: 999px;\n      padding: 2px 8px;\n      line-height: 1.4;\n    }\n    .state-body { padding: 10px; }\n    .kv-table {\n      border: 1px solid var(--border);\n      border-radius: 4px;\n      overflow: hidden;\n    }\n    .kv-row {\n      display: grid;\n      grid-template-columns: 1fr auto 2fr;\n      gap: 8px;\n      padding: 4px 10px;\n      align-items: baseline;\n      border-bottom: 1px solid var(--vscode-panel-border);\n      background: var(--vscode-editor-background);\n      transition: background-color .15s ease, border-left-color .15s ease;\n      border-left: 3px solid transparent;\n    }\n    .kv-row:last-child { border-bottom: none; }\n    .kv-row.changed {\n      background: var(--vscode-editor-findMatchHighlightBackground);\n      border-left: 3px solid var(--vscode-editor-findMatchHighlightBorder);\n      color: var(--vscode-editor-foreground);\n    }\n    .changed-element {\n      background: var(--vscode-editor-findMatchBackground);\n      border-radius: 3px;\n      padding: 2px 4px;\n      box-shadow: 0 0 0 2px var(--vscode-editor-findMatchBorder);\n      color: var(--vscode-editor-foreground);\n    }\n    .kv-key {\n      font-family: var(--mono);\n      background: transparent;\n      word-break: break-all;\n      font-size: 11px;\n    }\n    .kv-sep { color: var(--vscode-descriptionForeground); background: transparent; }\n    .kv-val {\n      font-family: var(--mono);\n      font-size: 11px;\n      background: transparent;\n      word-break: break-all;\n      display: flex; align-items: flex-start; gap: 6px;\n    }\n    .kv-toggle {\n      border: none; background: transparent; font-size: 12px; line-height: 1;\n      cursor: pointer; color: var(--vscode-descriptionForeground); padding: 0 2px;\n    }\n    .kv-val.collapsed .kv-content code {\n      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;\n    }\n    // .kv-content { display: block; }\n    ul.list {\n      margin: 4px 0 0 1rem;\n      padding: 0;\n      list-style-position: outside;\n    }\n    ul.list li {\n      font-family: var(--mono);\n      font-size: 11px;\n      line-height: 1.4;\n      background: transparent;\n      color: var(--vscode-foreground);\n      margin: 2px 0;\n    }\n    code {\n      background: transparent;\n      color: var(--vscode-foreground);\n      padding: 2px 4px;\n      border-radius: 3px;\n      font-family: var(--mono);\n    }\n    .kv-val.collapsed .kv-content code {\n      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;\n    }\n    .kv-content { display: block; }\n    .action-chip { cursor: help; }\n    .result-header {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 12px 16px;\n      margin: 8px;\n      border-radius: 6px;\n      font-weight: 600;\n      flex-wrap: wrap;\n    }\n    .result-violation {\n      background: var(--vscode-inputValidation-errorBackground);\n      border: 1px solid var(--vscode-inputValidation-errorBorder);\n      color: var(--vscode-inputValidation-errorForeground, var(--vscode-foreground));\n    }\n    .result-success {\n      background: var(--vscode-inputValidation-infoBackground);\n      border: 1px solid var(--vscode-inputValidation-infoBorder);\n      color: var(--vscode-inputValidation-infoForeground, var(--vscode-foreground));\n    }\n    .result-icon { font-size: 18px; }\n    .result-label { font-size: 14px; }\n    .result-details {\n      width: 100%;\n      font-size: 12px;\n      font-weight: normal;\n      color: var(--vscode-descriptionForeground);\n      margin-top: 4px;\n    }\n    .theory-section {\n      margin: 8px;\n      border: 1px solid var(--vscode-panel-border);\n      border-radius: 6px;\n      background: var(--vscode-editorWidget-background);\n    }\n    .theory-header {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      padding: 8px 12px;\n      cursor: pointer;\n      font-weight: 600;\n      font-size: 13px;\n    }\n    .theory-toggle {\n      font-size: 12px;\n      color: var(--vscode-descriptionForeground);\n    }\n    .theory-label {\n      color: var(--vscode-foreground);\n    }\n    .theory-content {\n      padding: 8px;\n      border-top: 1px solid var(--vscode-panel-border);\n    }\n    .mc-toolbar {\n      display: flex;\n      justify-content: flex-end;\n      padding: 4px 8px;\n    }\n    .mc-toggle-link {\n      font-size: 11px;\n      color: var(--vscode-textLink-foreground);\n      cursor: pointer;\n      text-decoration: none;\n      background: none;\n      border: none;\n      padding: 2px 6px;\n      border-radius: 3px;\n    }\n    .mc-toggle-link:hover {\n      text-decoration: underline;\n      background: var(--vscode-toolbar-hoverBackground);\n    }\n    .mc-json-view {\n      margin: 8px;\n      background: var(--vscode-editor-background);\n      border: 1px solid var(--vscode-panel-border);\n      border-radius: 6px;\n      position: relative;\n      max-height: 600px;\n    }\n    .mc-json-content {\n      padding: 12px;\n      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;\n      font-size: 12px;\n      white-space: pre;\n      overflow: auto;\n      max-height: 600px;\n    }\n    .mc-copy-button {\n      position: absolute;\n      top: 8px;\n      right: 8px;\n      display: inline-flex;\n      align-items: center;\n      gap: 4px;\n      font-size: 11px;\n      color: var(--vscode-foreground);\n      background: var(--vscode-button-secondaryBackground);\n      border: 1px solid var(--vscode-panel-border);\n      border-radius: 4px;\n      padding: 4px 8px;\n      cursor: pointer;\n      transition: background 0.15s, opacity 0.15s;\n      opacity: 0;\n    }\n    .mc-json-view:hover .mc-copy-button,\n    .mc-json-content:hover ~ .mc-copy-button {\n      opacity: 1;\n    }\n    .mc-copy-button:hover {\n      background: var(--vscode-button-secondaryHoverBackground);\n    }\n    .mc-copy-button svg {\n      width: 14px;\n      height: 14px;\n    }\n    .json-key { color: var(--vscode-symbolIcon-propertyForeground, #9cdcfe); }\n    .json-string { color: var(--vscode-symbolIcon-stringForeground, #ce9178); }\n    .json-number { color: var(--vscode-symbolIcon-numberForeground, #b5cea8); }\n    .json-boolean { color: var(--vscode-symbolIcon-booleanForeground, #569cd6); }\n    .json-null { color: var(--vscode-symbolIcon-nullForeground, #569cd6); }\n  '}),n("div",{className:"mc-root",children:[r("div",{className:"mc-toolbar",children:r("button",{className:"mc-toggle-link",onClick:()=>c(!l),children:l?"Show formatted":"Show JSON"})}),l?n("div",{className:"mc-json-view",children:[r(m,{text:p,className:"mc-copy-button"}),r("div",{className:"mc-json-content",children:(y=p,y.split(/("(?:[^"\\]|\\.)*"|\btrue\b|\bfalse\b|\bnull\b|-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?)/g).map(((n,e)=>{if(!n)return null;if(n.startsWith('"')){const o=-1!==y.indexOf(n+":")||-1!==y.indexOf(n+" :");return r("span",{className:o?"json-key":"json-string",children:n},e)}return"true"===n||"false"===n?r("span",{className:"json-boolean",children:n},e):"null"===n?r("span",{className:"json-null",children:n},e):/^-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?$/.test(n)?r("span",{className:"json-number",children:n},e):r("span",{children:n},e)})))})]}):n(e,{children:["result"in t&&r(e,{children:"no_violation_found"===t.result?r(v,{resultType:"no_violation_found",exploredStates:t.explored_states,terminationReason:t.termination_reason}):r(v,{resultType:"found_violation",violation:t.violation})}),x&&r(g,{theory:x}),b.length>0?n(e,{children:[r("div",{className:"mc-trace "+(d?"vertical":"horizontal"),children:b.map(((n,e)=>{const o=function(n,e){const r=new Map;if(!n)return r;const o=new Set([...Object.keys(n),...Object.keys(e)]);for(const t of o){if(!(t in n)||!(t in e)){r.set(t,{type:"full"});continue}const o=n[t],s=e[t];if(!a(o,s))if(Array.isArray(o)&&Array.isArray(s)){const n=i(o,s);n.size>0&&r.set(t,{type:"array",changedIndices:n})}else r.set(t,{type:"full"})}return r}(e>0?b[e-1].fields:void 0,n.fields);return r(h,{st:n,changes:o},n.index)}))}),n("div",{className:"mc-summary",children:[r("strong",{children:"Summary:"})," ",b.length," states in trace"]})]}):"result"in t&&"found_violation"===t.result&&r("div",{className:"mc-summary",children:r("strong",{children:"No trace available"})})]})]})]});var y};export{b as default};