// window;import{jsxs as n,Fragment as e,jsx as r}from"react/jsx-runtime";import*as t from"react";function o(n){if(!n.includes(".")||/^-?\d+\.\d+$/.test(n))return n;const e=n.split(".");return e[e.length-1]||n}function a(n,e){if(n===e)return!0;if(null==n||null==e)return n===e;if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!a(n[r],e[r]))return!1;return!0}if("object"==typeof n&&"object"==typeof e){const r=n,t=e,o=Object.keys(r),i=Object.keys(t);if(o.length!==i.length)return!1;for(const n of o){if(!(n in t))return!1;if(!a(r[n],t[n]))return!1}return!0}return!1}function i(e){if(Array.isArray(e)){if(0===e.length)return r("code",{children:"[]"});return 2===e.length&&e.every((n=>"object"!=typeof n||null==n||Array.isArray(n)))?n("code",{children:["(",i(e[0]),", ",i(e[1]),")"]}):(t=e).length<=6&&t.every((n=>null==n||"string"==typeof n||"number"==typeof n||"boolean"==typeof n||Array.isArray(n)&&n.every((n=>null==n||"string"==typeof n||"number"==typeof n||"boolean"==typeof n))))?function(e){const t=[];return e.forEach(((n,o)=>{t.push(i(n)),o<e.length-1&&t.push(r("span",{children:", "},`comma-${o}`))})),n("code",{children:["[",t,"]"]})}(e):r("ul",{className:"list",children:e.map(((n,e)=>r("li",{children:i(n)},e)))})}var t;return r("code","object"==typeof e&&null!==e?{children:JSON.stringify(e)}:"string"==typeof e?{children:o(e)}:{children:String(e)})}function l(n){if(Array.isArray(n))return n.length>0&&Array.isArray(n[0])?`Array(${n.length}) of tuples`:`Array(${n.length})`;if("object"==typeof n&&null!==n)try{return JSON.stringify(n).slice(0,80)+"…"}catch{return"[object]"}if("string"==typeof n){const e=o(n).replace(/\s+/g," ");return e.length>80?e.slice(0,80)+"…":e}return String(n)}const s=({k:e,v:o,changed:a})=>{const s=function(n){return!!Array.isArray(n)||"object"==typeof n&&null!==n||!("string"!=typeof n||!(n.includes("\n")||n.length>60))}(o),[d,c]=t.useState(!s);return n("div",{className:`kv-row ${s?"has-toggle":""} ${a?"changed":""}`,children:[r("div",{className:"kv-key",children:r("code",{children:e})}),r("div",{className:"kv-sep",children:"↦"}),n("div",{className:"kv-val "+(d?"expanded":"collapsed"),children:[s&&r("button",{className:"kv-toggle",type:"button",onClick:()=>c((n=>!n)),"aria-label":d?"Collapse value":"Expand value",title:d?"Collapse":"Expand",children:d?"▼":"▶"}),r("div",{className:"kv-content",children:d?i(o):r("code",{children:l(o)})})]})]})},d=({st:e,highlighted:a=!1,changedKeys:i})=>{const[l,d]=t.useState(!0),c=Object.entries(e.fields);return n("div",{className:"state-card "+(a?"is-highlighted":""),children:[n("div",{className:"state-header",onClick:()=>d((n=>!n)),children:[n("div",{className:"state-title",children:[r("span",{className:"action-chip",title:e.actionFull??e.action??"",children:e.action?o(e.action):"(no action)"}),n("span",{className:"state-id",children:["(index: ",e.index,")"]})]}),r("div",{className:"state-toggle",children:l?"▼":"▶"})]}),l&&r("div",{className:"state-body",children:r("div",{className:"kv-table",children:c.map((([n,e])=>r(s,{k:n,v:e,changed:i?.has(n)},n)))})})]})},c=({trace:t,layout:o="vertical"})=>{const i="vertical"===o;return n(e,{children:[r("style",{children:'\n    .mc-root {\n      font-family: system-ui, -apple-system, sans-serif;\n      max-width: 100%;\n      overflow: auto;\n    }\n    .mc-trace.vertical {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n      padding: 8px;\n    }\n    .mc-trace.horizontal {\n      display: flex;\n      flex-direction: row;\n      gap: 8px;\n      padding: 8px;\n      overflow-x: auto;\n    }\n    .mc-summary {\n      margin: 12px 8px;\n      padding: 8px 12px;\n      background: #f8f9fa;\n      border: 1px solid #dee2e6;\n      border-radius: 4px;\n    }\n    .state-card {\n      --border: #bfbfbf;\n      --header: #e6e6e6;\n      --mono: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;\n      background: #fff;\n      border: 1px solid var(--border);\n      border-radius: 6px;\n      min-width: 320px;\n      max-width: 720px;\n      box-shadow: 0 1px 2px rgba(0,0,0,.08);\n      overflow: hidden;\n    }\n    .state-card.is-highlighted {\n      outline: 2px solid #ffc107;\n      box-shadow: 0 0 0 3px rgba(255,193,7,.25);\n    }\n    .state-header {\n      background: var(--header);\n      border-bottom: 1px solid var(--border);\n      padding: 6px 10px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      font-weight: 600;\n      cursor: pointer;\n    }\n    .state-title {\n      display: flex;\n      gap: 6px;\n      align-items: baseline;\n    }\n    .state-id { font-size: 12px; color: #666; }\n    .state-toggle { font-size: 12px; color: #666; user-select: none; }\n    .action-chip {\n      display: inline-block;\n      font-family: var(--mono);\n      font-size: 11px;\n      font-weight: normal;\n      background: #eaf2ff;\n      color: #3b3b3dff;\n      border: 1px solid #a9c3feff;\n      border-radius: 999px;\n      padding: 2px 8px;\n      line-height: 1.4;\n    }\n    .state-body { padding: 10px; }\n    .kv-table {\n      border: 1px solid var(--border);\n      border-radius: 4px;\n      overflow: hidden;\n    }\n    .kv-row {\n      display: grid;\n      grid-template-columns: 1fr auto 2fr;\n      gap: 8px;\n      padding: 4px 10px;\n      align-items: baseline;\n      border-bottom: 1px solid #eee;\n      background: white;\n      transition: background-color .15s ease, border-left-color .15s ease;\n      border-left: 3px solid transparent;\n    }\n    .kv-row:last-child { border-bottom: none; }\n    .kv-row.changed {\n      background: #fff7e6;\n      border-left: 3px solid #faad14;\n    }\n    .kv-row.changed code { background: #fff1d6; }\n    .kv-key {\n      font-family: var(--mono);\n      background: transparent;\n      word-break: break-all;\n      font-size: 11px;\n    }\n    .kv-sep { color: #888; background: transparent; }\n    .kv-val {\n      font-family: var(--mono);\n      font-size: 11px;\n      background: transparent;\n      word-break: break-all;\n      display: flex; align-items: flex-start; gap: 6px;\n    }\n    .kv-toggle {\n      border: none; background: transparent; font-size: 12px; line-height: 1;\n      cursor: pointer; color: #666; padding: 0 2px;\n    }\n    .kv-val.collapsed .kv-content code {\n      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;\n    }\n    // .kv-content { display: block; }\n    ul.list {\n      margin: 4px 0 0 1rem;\n      padding: 0;\n      list-style-position: outside;\n    }\n    ul.list li {\n      font-family: var(--mono);\n      font-size: 11px;\n      line-height: 1.4;\n      background: transparent;\n      color: #333;\n      margin: 2px 0;\n    }\n    code {\n      background: transparent;\n      color: #333;\n      padding: 2px 4px;\n      border-radius: 3px;\n      font-family: var(--mono);\n    }\n    .kv-val.collapsed .kv-content code {\n      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;\n    }\n    .kv-content { display: block; }\n    .action-chip { cursor: help; }\n  '}),n("div",{className:"mc-root",children:[r("div",{className:"mc-trace "+(i?"vertical":"horizontal"),children:t.map(((n,e)=>{const o=function(n,e){const r=new Set;if(!n)return r;const t=new Set([...Object.keys(n),...Object.keys(e)]);for(const o of t)o in n&&o in e&&a(n[o],e[o])||r.add(o);return r}(e>0?t[e-1].fields:void 0,n.fields);return r(d,{st:n,changedKeys:o},n.index)}))}),n("div",{className:"mc-summary",children:[r("strong",{children:"Summary:"})," ",t.length," states"]})]})]})};export{c as default};
